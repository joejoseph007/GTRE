
Data_Input = xlsread('Book1.xlsx', 'Data Input');
DO=Data_Input;
DI=Data_Input;

%Angle
DO(:,7)=DI(:,8).*(DI(:,6))+DI(:,7);

A=2*DI(:,3).*(DI(:,4).*cosd(DO(:,7))+DI(:,5)-DI(:,1).*cosd(DI(:,8)));
B=2*DI(:,3).*(DI(:,4).*sind(DO(:,7))-DI(:,1).*sind(DI(:,8)));
C=DI(:,1).^2-DI(:,2).^2+DI(:,3).^2+DI(:,4).^2+DI(:,5).^2+2*(DI(:,4).*cosd(DO(:,7))).*(DI(:,5)-DI(:,1).*cosd(DI(:,8)))-2*DI(:,5).*DI(:,1).*cosd(DI(:,8))-2*(DI(:,4).*sind(DO(:,7)).*DI(:,1).*sind(DI(:,8)));

D=2*DI(:,2).*(DI(:,1).*cosd(DI(:,8))-DI(:,5)-DI(:,4).*cosd(DO(:,7)));
E=2*DI(:,2).*(DI(:,1).*sind(DI(:,8))-DI(:,4).*sind(DO(:,7)));
F=DI(:,1).^2+DI(:,2).^2-DI(:,3).^2+DI(:,4).^2+DI(:,5).^2-2*(DI(:,1).*cosd(DI(:,8))).*(DI(:,5)+DI(:,4).*cosd(DO(:,7)))+2*DI(:,4).*DI(:,5).*cosd(DO(:,7))-2*(DI(:,4).*sind(DO(:,7)).*DI(:,1).*sind(DI(:,8)));

W(:,1)=(-E(:,1)+(E(:,1).^2-(F(:,1).^2-D(:,1).^2)).^0.5)./((F(:,1)-D(:,1)));
X(:,1)=(-B(:,1)-(B(:,1).^2-(C(:,1).^2-A(:,1).^2)).^0.5)./((C(:,1)-A(:,1)));

Y(:,1)=(-E(:,1)-(E(:,1).^2-(F(:,1).^2-D(:,1).^2)).^0.5)./((F(:,1)-D(:,1)));
Z(:,1)=(-B(:,1)+(B(:,1).^2-(C(:,1).^2-A(:,1).^2)).^0.5)./((C(:,1)-A(:,1)));

for k=1:1:numel(DI)/length(DI)
if imag(X(k,1))~=0 
X(k,1)=NaN+0i;
end
if imag(Y(k,1))~=0
Y(k,1)=NaN+0i;
end
if imag(W(k,1))~=0
W(k,1)=NaN+0i;
end
if imag(Z(k,1))~=0
Z(k,1)=NaN+0i;
end
end


DO(:,1)=2*atand(W(:,1));
DO(:,4)=2*atand(X(:,1));
DO(:,10)=2*atand(Y(:,1));
DO(:,13)=2*atand(Z(:,1));

%Velocity
DO(:,8)=DI(:,9).*(DI(:,6));

DO(:,2)= (DI(:,4).*DO(:,8).*sind(DO(:,7)-DO(:,4))+DI(:,1).*DI(:,9).*sind(DO(:,4)-DI(:,8)))./(DI(:,2).*sind(DO(:,1)-DO(:,4)));
DO(:,5)= (DI(:,1).*DI(:,9).*sind(DI(:,8))+DI(:,2).*DO(:,2).*sind(DO(:,1))-DI(:,4).*DO(:,8).*sind(DO(:,7)))./(DI(:,3).*sind(DO(:,4)));

DO(:,11)= (DI(:,4).*DO(:,8).*sind(DO(:,7)-DO(:,13))+DI(:,1).*DI(:,9).*sind(DO(:,13)-DI(:,8)))./(DI(:,2).*sind(DO(:,10)-DO(:,13)));
DO(:,14)= (DI(:,1).*DI(:,9).*sind(DI(:,8))+DI(:,2).*DO(:,11).*sind(DO(:,10))-DI(:,4).*DO(:,8).*sind(DO(:,7)))./(DI(:,3).*sind(DO(:,13)));

%Acceleration
DO(:,9)=DI(:,10).*DI(:,6);

DO(:,3)= (-DI(:,1).*(DI(:,10).*sind(DI(:,8)-DO(:,4))+DI(:,9).^2.*cosd(DI(:,8)-DO(:,4)))...
        -DI(:,2).*DO(:,2).^2.*cosd(DO(:,1)-DO(:,4))...
        +DI(:,4).*(DO(:,9).*sind(DO(:,7)-DO(:,4))+DO(:,8).^2.*cosd(DO(:,7)-DO(:,4)))...
        +DI(:,3).*DO(:,5).^2 )./(DI(:,2).*sind(DO(:,1)-DO(:,4)));

DO(:,6)= (DI(:,1).*(DI(:,10).*sind(DI(:,8)-DO(:,1))+DI(:,9).^2.*cosd(DI(:,8)-DO(:,1)))...
        -DI(:,3).*DO(:,5).^2.*cosd(DO(:,1)-DO(:,4))...
        +DI(:,4).*(DO(:,9).*sind(DO(:,1)+DO(:,7))-DO(:,8).^2.*cosd(DO(:,1)-DO(:,7)))...
        +DI(:,2).*DO(:,2).^2 )./(DI(:,3).*sind(DO(:,4)-DO(:,1)));

DO(:,12)= (-DI(:,1).*(DI(:,10).*sind(DI(:,8)-DO(:,13))+DI(:,9).^2.*cosd(DI(:,8)-DO(:,13)))...
        -DI(:,2).*DO(:,11).^2.*cosd(DO(:,10)-DO(:,13))...
        +DI(:,4).*(DO(:,9).*sind(DO(:,7)-DO(:,13))+DO(:,8).^2.*cosd(DO(:,7)-DO(:,13)))...
        +DI(:,3).*DO(:,14).^2 )./(DI(:,2).*sind(DO(:,10)-DO(:,13)));

DO(:,15)= (DI(:,1).*(DI(:,10).*sind(DI(:,8)-DO(:,10))+DI(:,9).^2.*cosd(DI(:,8)-DO(:,10)))...
        -DI(:,3).*DO(:,14).^2.*cosd(DO(:,10)-DO(:,4))...
        +DI(:,4).*(DO(:,9).*sind(DO(:,10)+DO(:,7))-DO(:,8).^2.*cosd(DO(:,10)-DO(:,7)))...
        +DI(:,2).*DO(:,11).^2 )./(DI(:,3).*sind(DO(:,13)-DO(:,10)));

    

